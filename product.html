<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Product</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: #f5f5f5;
    padding: 20px;
}
.card {
    max-width: 700px;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 12px;
}
img {
    width: 100%;
    border-radius: 8px;
}
.buy-btn {
    margin-top: 15px;
    padding: 12px;
    width: 100%;
    border: none;
    background: #6366f1;
    color: white;
    font-size: 16px;
    border-radius: 8px;
    cursor: pointer;
}
</style>
</head>
<body>

<div class="card">
    <h2 id="name"></h2>
    <p id="seller"></p>
    <img id="image">
    <p id="desc"></p>
    <h3 id="price"></h3>

<hr>

<h3>Reviews</h3>

<div id="reviews-summary">
  <p id="reviews-count">0 reviews</p>
</div>

<div id="review-form" style="margin-top:15px;">
  <textarea id="review-text" placeholder="Write your note..." style="width:100%;padding:8px;"></textarea>

  <div style="margin-top:10px;">
    <button id="like-btn">üëç Like</button>
    <button id="dislike-btn">üëé Dislike</button>
  </div>

  <p id="review-message" style="color:red;margin-top:8px;"></p>
</div>

<div id="reviews-list" style="margin-top:20px;"></div>


<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
import { getFirestore, doc, setDoc, getDocs, collection } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCh2Pf1c1Gb7fQCQy64WmNYvWBKffwiuOs",
  authDomain: "creoveo-7da32.firebaseapp.com",
  projectId: "creoveo-7da32",
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentUser = null;

onAuthStateChanged(auth, user => {
  currentUser = user;
});


    

    <!-- ÿ≤ÿ± PayPal -->
    <div id="paypal-button-container"></div>
</div>

  <script src="https://www.paypal.com/sdk/js?client-id=Ady-fs_MNNG5Ue22tNNapD9abvFULboMBDy5vAbpDYt8jCVNkqeyS1hssK58OTIWLWQt5xHxZlcZ_hSB&currency=USD&intent=capture"></script>
<script>
const params = new URLSearchParams(window.location.search);
const productId = params.get('id');

if (!productId) {
    alert('Product not found');
}

// ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖŸÜÿ™ÿ¨
fetch('https://backend-creovea.onrender.com/products')
.then(res => res.json())
.then(products => {
    const product = products.find(p => p.id === productId);
    if (!product) return alert('Product not found');

    document.getElementById('name').textContent = product.name;
    document.getElementById('seller').textContent = 'Seller: ' + product.seller;
    document.getElementById('desc').textContent = product.description;
    document.getElementById('price').textContent = '$' + product.price;
    document.getElementById('image').src = product.previewImage;

    // PayPal
    paypal.Buttons({
        createOrder: (data, actions) => {
            return actions.order.create({
                purchase_units: [{
                    amount: { value: product.price }
                }]
            });
        },
        onApprove: async (data) => {
            const res = await fetch('https://backend-creovea.onrender.com/record-payment', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    productId: product.id,
                    orderId: data.orderID
                })
            });
            const result = await res.json();
            if (result.success) {
                window.location.href = result.downloadUrl;
            } else {
                alert('Payment failed');
            }
        }
    }).render('#paypal-button-container');
});


<script type="module">
import { doc, setDoc, getDocs, collection } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

const likeBtn = document.getElementById('like-btn');
const dislikeBtn = document.getElementById('dislike-btn');
const reviewText = document.getElementById('review-text');
const message = document.getElementById('review-message');
const reviewsList = document.getElementById('reviews-list');
const reviewsCount = document.getElementById('reviews-count');

async function loadReviews() {
  const snap = await getDocs(collection(db, 'products', productId, 'reviews'));
  reviewsList.innerHTML = '';
  reviewsCount.textContent = `${snap.size} reviews`;

  snap.forEach(doc => {
    const r = doc.data();
    const div = document.createElement('div');
    div.style.borderBottom = '1px solid #ddd';
    div.style.padding = '8px 0';
    div.innerHTML = `
      <strong>${r.type === 'like' ? 'üëç' : 'üëé'}</strong>
      <p>${r.text}</p>
    `;
    reviewsList.appendChild(div);
  });
}

async function submitReview(type) {
  if (!currentUser) {
    message.textContent = 'You must be logged in';
    return;
  }

  const text = reviewText.value.trim();
  if (!text) {
    message.textContent = 'Write a note first';
    return;
  }

  const reviewRef = doc(db, 'products', productId, 'reviews', currentUser.uid);

  await setDoc(reviewRef, {
    userId: currentUser.uid,
    type,
    text,
    createdAt: new Date()
  });

  message.style.color = 'green';
  message.textContent = 'Review submitted ‚úÖ';
  reviewText.value = '';
  loadReviews();
}

likeBtn.onclick = () => submitReview('like');
dislikeBtn.onclick = () => submitReview('dislike');

loadReviews();


    
</script>
</body>
</html>
